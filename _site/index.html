<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="krystism's blog based on GitHub Pages" />
    <link rel="stylesheet" type="text/css" media="screen" href="/themes/slate/stylesheets/stylesheet.css">

    <title></title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/krystism/">View on GitHub</a>
          <h1 id="project_title"><a href="/">Hello World!</a></h1>
          <h2 id="project_tagline">echo "Hello World!"</h2>

	  <!--
         <section id="downloads">
            <a class="zip_download_link" href="#">Download this project as a .zip file</a>
            <a class="tar_download_link" href="#">Download this project as a tar.gz file</a>
          </section>
	-->
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
       <h1></h1>
<!--
<ul class="post-list">
    
        <a href="/linux/2015/04/26/scriptnote.html"> 使用sed删除所有的换行符和空格符  </a>
        2015-04-26 <br>
    
        <a href="/linux/2015/04/26/HowToInstallJekyll.html"> ubuntu14.04 安装jekyll  </a>
        2015-04-26 <br>
    
        <a href="/linux/2015/04/02/%E4%BD%BF%E7%94%A8moderncv%E5%88%9B%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%AE%80%E5%8E%86.html"> 使用moderncv创建个人简历  </a>
        2015-04-02 <br>
    
        <a href="/%E8%99%9A%E6%8B%9F%E5%8C%96/2015/03/18/%E5%88%B6%E4%BD%9Cwindows-puppet%E9%95%9C%E5%83%8F%E8%BF%87%E7%A8%8B.html"> 制作windows puppet镜像  </a>
        2015-03-18 <br>
    
        <a href="/linux/2015/03/18/%E4%BD%BF%E7%94%A8bash%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%E7%BB%9F%E8%AE%A1%E5%8D%95%E8%AF%8D%E9%A2%91%E6%95%B0.html"> 使用bash关联数组统计单词频数  </a>
        2015-03-18 <br>
    
        <a href="/windows/2015/03/18/windows%E5%AE%89%E8%A3%85puppet-agent%E9%97%AE%E9%A2%98.html"> windows系统安装puppet agent  </a>
        2015-03-18 <br>
    
        <a href="/%E8%99%9A%E6%8B%9F%E5%8C%96/2015/03/18/kvm%E5%90%AF%E5%8A%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0.html"> kvm的常用参数  </a>
        2015-03-18 <br>
    
        <a href="/linux/2015/03/18/bash%E6%95%B0%E7%BB%84%E6%93%8D%E4%BD%9C.html"> bash数组操作  </a>
        2015-03-18 <br>
    
        <a href="/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/2014/11/30/swap%E5%87%BD%E6%95%B0%E9%99%B7%E9%98%B1.html"> swap函数陷阱  </a>
        2014-11-30 <br>
    
        <a href="/linux/2014/11/30/bash%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%89%8D%E7%BE%8E%E5%85%83%E7%AC%A6%E5%8F%B7%E7%9A%84%E4%BD%9C%E7%94%A8.html"> bash字符串前美元符号的作用  </a>
        2014-11-30 <br>
    
        <a href="/linux/2014/11/25/%E5%AE%89%E8%A3%85nvidia%E9%A9%B1%E5%8A%A8.html"> ubuntu安装Nvidia驱动  </a>
        2014-11-25 <br>
    
        <a href="/linux/2014/11/25/ubuntu%E7%BB%88%E7%AB%AF%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81.html"> ubuntu终端显示中文乱码  </a>
        2014-11-25 <br>
    
        <a href="/%E7%AE%97%E6%B3%95/2014/10/24/%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95%E5%92%8C%E6%B4%97%E7%89%8C%E7%AE%97%E6%B3%95.html"> 随机数和洗牌算法  </a>
        2014-10-24 <br>
    
        <a href="/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/2014/09/20/java-concurrency.html"> Java 中的并发  </a>
        2014-09-20 <br>
    
        <a href="/%E7%AE%97%E6%B3%95/2013/10/27/%E5%B0%8F%E7%B1%B32013%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AF%95%E7%AE%97%E6%B3%95%E9%A2%98-%E6%9C%8B%E5%8F%8B%E5%9C%88.html"> 小米2013校招笔试算法题-朋友圈  </a>
        2013-10-27 <br>
    
</ul>
-->

<!-- 遍历分页后的文章 -->

  <h1><a href="/linux/2015/04/26/scriptnote.html">使用sed删除所有的换行符和空格符</a></h1>
  <div class="author">
	  分类:
	  
	  
	  <a href="/categories.html#-ref">linux</a>
	  
	  
	  |
	  标签:
	  
	  
	  <a href="/tags.html#-ref">linux</a>
	  
	  ,
	  
	  
	  <a href="/tags.html#-ref">sed</a>
	  
	  
	  |
	  发表时间:<span class="date">2015-04-26</span>
  </div>
  <!--
  <p class="author">
    <span class="date">26 Apr 2015</span>
  </p>
  -->
  <div class="content">
    <h2>1. 删除所有的换行符和空格符</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">sed  -e <span class="s1">&#39;:a;N;s/\n//;s/ //g;ba&#39;</span> test.txt
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">cat test.txt <span class="p">|</span> tr -d <span class="s1">&#39;\n &#39;</span>
</code></pre></div>
<h2>2. spark on hive</h2>

<ul>
<li>spark编译了hive</li>
<li>必须把hive-site.xml 复制到spark配置目录中</li>
<li>必须把hive使用的元数据库的驱动加入到SPARK_CLASSPATH中</li>
</ul>

  </div>
  <br/><br/>

  <h1><a href="/linux/2015/04/26/HowToInstallJekyll.html">ubuntu14.04 安装jekyll</a></h1>
  <div class="author">
	  分类:
	  
	  
	  <a href="/categories.html#-ref">linux</a>
	  
	  
	  |
	  标签:
	  
	  
	  <a href="/tags.html#-ref">ubuntu jekyll</a>
	  
	  
	  |
	  发表时间:<span class="date">2015-04-26</span>
  </div>
  <!--
  <p class="author">
    <span class="date">26 Apr 2015</span>
  </p>
  -->
  <div class="content">
    <p>注意不要使用apt-get直接安装jekyll，默认是老版本的，运行不了。</p>

<p>首先需要安装依赖包，注意不仅要安装ruby，还需要ruby-dev和nodejs</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get install ruby ruby-dev make gcc nodejs
</code></pre></div>
<p>然后使用gem 安装jekyll</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo gem install jekyll --no-rdoc --no-ri
</code></pre></div>
<p>但是会出现</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ERROR:  While executing gem ... (NoMethodError)
    undefined method `size&#39; for nil:NilClass
</code></pre></div>
<p>解决方法是删除cache文件，</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">krystism@lenovo:~/notes/linux$ gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.23
  - RUBY VERSION: 1.9.3 (2013-11-22 patchlevel 484) [x86_64-linux]
  - INSTALLATION DIRECTORY: /var/lib/gems/1.9.1
  - RUBY EXECUTABLE: /usr/bin/ruby1.9.1
  - EXECUTABLE DIRECTORY: /usr/local/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /var/lib/gems/1.9.1
     - /home/fgp/.gem/ruby/1.9.1
  - GEM CONFIGURATION:
     - :update_sources =&gt; true
     - :verbose =&gt; true
     - :benchmark =&gt; false
     - :backtrace =&gt; false
     - :bulk_threshold =&gt; 1000
  - REMOTE SOURCES:
     - http://rubygems.org/
</code></pre></div>
<p>得到<code>GEM PATHS</code>, 进去删除cache文件。</p>

  </div>
  <br/><br/>

  <h1><a href="/linux/2015/04/02/%E4%BD%BF%E7%94%A8moderncv%E5%88%9B%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%AE%80%E5%8E%86.html">使用moderncv创建个人简历</a></h1>
  <div class="author">
	  分类:
	  
	  
	  <a href="/categories.html#-ref">linux</a>
	  
	  
	  |
	  标签:
	  
	  
	  <a href="/tags.html#-ref">ubuntu moderncv</a>
	  
	  
	  |
	  发表时间:<span class="date">2015-04-02</span>
  </div>
  <!--
  <p class="author">
    <span class="date">02 Apr 2015</span>
  </p>
  -->
  <div class="content">
    <h2>0. 编译环境</h2>

<ul>
<li>操作系统ubuntu14.04 64 位</li>
<li>pdfTeX 3.1415926-2.5-1.40.14 (TeX Live 2013/Debian)</li>
<li>kpathsea version 6.1.1</li>
</ul>

<h2>1. 安装latex 以及必要包</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get install texlive-latex-base
sudo apt-get install texlive-latex-extra
sudo apt-get install latex-cjk-chinese <span class="c"># 支持中文</span>
sudo apt-get install texlive-fonts-recommended texlive-font-extra <span class="c">#安装字体</span>
</code></pre></div>
<h2>2. 下载moderncv</h2>

<p>进入官网<a href="http://www.ctan.org/tex-archive/macros/latex/contrib/moderncv/">modernc</a>下载，解压缩</p>

<h2>3. 创建个人简历</h2>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>moderncv <span class="o">&amp;&amp;</span> mkdir me
cp examples/template-zh.tex me/me.tex
<span class="nb">cd </span>me <span class="o">&amp;&amp;</span> cp ../*.sty .

<span class="c">#编译</span>
pdflatex me.tex
</code></pre></div>
<h2>4. 从模版中修改，创建个人简历</h2>

<p>修改me.tex,编译成pdf就OK了</p>

  </div>
  <br/><br/>

  <h1><a href="/%E8%99%9A%E6%8B%9F%E5%8C%96/2015/03/18/%E5%88%B6%E4%BD%9Cwindows-puppet%E9%95%9C%E5%83%8F%E8%BF%87%E7%A8%8B.html">制作windows puppet镜像</a></h1>
  <div class="author">
	  分类:
	  
	  
	  <a href="/categories.html#-ref">虚拟化</a>
	  
	  
	  |
	  标签:
	  
	  
	  <a href="/tags.html#-ref">puppet</a>
	  
	  ,
	  
	  
	  <a href="/tags.html#-ref">kvm</a>
	  
	  ,
	  
	  
	  <a href="/tags.html#-ref">虚拟化</a>
	  
	  ,
	  
	  
	  <a href="/tags.html#-ref">windows</a>
	  
	  
	  |
	  发表时间:<span class="date">2015-03-18</span>
  </div>
  <!--
  <p class="author">
    <span class="date">18 Mar 2015</span>
  </p>
  -->
  <div class="content">
    <p>由于电信需要远程部署软件，拟使用puppet进行远程服务管理</p>

<h2>前提</h2>

<ol>
<li>windows系统已经安装</li>
<li>windows已经安装virtio driver</li>
<li>远程桌面开启，最好关闭防火墙</li>
</ol>

<h2>设置MTU</h2>

<p>在没有安装cloudinit情况下需要手动配置mtu大小为1454，否则无法上网。</p>

<h2>设置hosts文件</h2>

<p>把一些常用的host放到C:/windows/system32/driver/etc/host，<strong>尤其是master的，务必设置！！</strong></p>

<h2>设置时间同步</h2>

<p>agent需要和master保持时间同步，因此需要设置windows更新时间服务器为master</p>

<h2>安装win32-dir</h2>

<p>需要安装win32-dir 版本大于0.43, 安装方法为管理员start command prompt with puppet, run:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">gem install win32-dir
</code></pre></div>
<h2>修改puppet facter下的timezone</h2>

<p>timezone默认输出中文，会出现编码错误,设置setcode 为英文字符，最好是世界时区标准格式</p>

<h2>安装clouinit</h2>

<p>下载地址:<a href="http://www.cloudbase.it/cloud-init-for-windows-instances/">官网</a></p>

<h2>关机</h2>

<p>在这前清空puppet ssl目录，位于C：/programdata，并根据实际情况可以设置puppet.conf 。为了减少磁盘文件大小，最好运行下磁盘
清理，并删除掉一些无用文件。</p>

<h2>格式转化</h2>

<p>把格式转化，一方面为了合并base image，另一方面也可以起到重新整理磁盘文件，减少文件大小，run：</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">qemu-img convert -O qcow2 origin.qcow2 new.qcow2
</code></pre></div>
<h2>上传镜像</h2>

<p>把镜像上传到glance下，记得<strong>设置os_type = windows</strong>否则，会出现RTC时间问题</p>

<h2>启动主机</h2>

<p>启动云主机，记得设置<strong>os_type = windows</strong>, 原因同上！</p>

  </div>
  <br/><br/>

  <h1><a href="/linux/2015/03/18/%E4%BD%BF%E7%94%A8bash%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%E7%BB%9F%E8%AE%A1%E5%8D%95%E8%AF%8D%E9%A2%91%E6%95%B0.html">使用bash关联数组统计单词频数</a></h1>
  <div class="author">
	  分类:
	  
	  
	  <a href="/categories.html#-ref">linux</a>
	  
	  
	  |
	  标签:
	  
	  
	  <a href="/tags.html#-ref">bash</a>
	  
	  ,
	  
	  
	  <a href="/tags.html#-ref">linux</a>
	  
	  
	  |
	  发表时间:<span class="date">2015-03-18</span>
  </div>
  <!--
  <p class="author">
    <span class="date">18 Mar 2015</span>
  </p>
  -->
  <div class="content">
    <p>从bash 4开始支持关联数组，使用前需要声明，即</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">declare</span> -A map
map<span class="o">[</span>key1<span class="o">]=</span>value1
map<span class="o">[</span>key2<span class="o">]=</span>value2
<span class="nv">map</span><span class="o">=([</span>key1<span class="o">]=</span>value1 <span class="o">[</span>key2<span class="o">]=</span>value2<span class="o">)</span>
<span class="c"># 获取keys</span>
<span class="nv">keys</span><span class="o">=</span><span class="k">${</span><span class="p">!map[@]</span><span class="k">}</span>
<span class="c"># 获取values</span>
<span class="nv">values</span><span class="o">=</span><span class="k">${</span><span class="nv">map</span><span class="p">[@]</span><span class="k">}</span>
</code></pre></div>
<p>利用关联数组，很容易实现单词统计,源码文件<a href="src/wordCount.sh">wordCount.sh</a></p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$# </span>-lt <span class="m">1</span> <span class="o">]]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Usage: $0 &lt;filename&gt;&quot;</span>
    <span class="nb">exit </span>1
<span class="k">fi</span>
<span class="nv">file</span><span class="o">=</span><span class="nv">$1</span>
<span class="nb">declare</span> -A count
<span class="k">for</span> word in <span class="k">$(</span>grep -P -o <span class="s1">&#39;\b\w+\b&#39;</span> <span class="nv">$file</span><span class="k">)</span>
<span class="k">do</span>
    <span class="nb">let </span>count<span class="o">[</span><span class="nv">$word</span><span class="o">]</span>++
<span class="k">done</span>
<span class="k">for</span> word in <span class="k">${</span><span class="p">!count[@]</span><span class="k">}</span>
<span class="k">do</span>
    <span class="nb">printf</span> <span class="s2">&quot;%-14s%s\n&quot;</span> <span class="nv">$word</span> <span class="k">${</span><span class="nv">count</span><span class="p">[</span><span class="nv">$word</span><span class="p">]</span><span class="k">}</span>
<span class="k">done</span>
</code></pre></div>
<p>使用方法</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">./wordCount.sh filename
</code></pre></div>
<p>或者从标准流中使用，如</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">echo</span> <span class="s2">&quot;Hello World! GoodBye World!&quot;</span> <span class="p">|</span> ./wordCount.sh -
</code></pre></div>
<p>输出为</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Hello         1
World         2
GoodBye       1
</code></pre></div>
  </div>
  <br/><br/>



<div class="pagination">
  
    <span>&laquo; Prev</span>
  

  
    
      <em>1</em>
    
  
    
      <!-- 注意路径使用/绝对路径，否则分页功能有错误 -->
      <a href="/page2">2</a>
    
  
    
      <!-- 注意路径使用/绝对路径，否则分页功能有错误 -->
      <a href="/page3">3</a>
    
  

  
    <a href="/page2">Next &raquo;</a>
  
</div>


      </section>
      <section id="comments" class="inner">
        
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Slate theme maintained by <a href="https://github.com/jasoncostello">Jason Costello</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

  </body>
</html>
